# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=lomiri-keyboard
pkgver=0_git20210815
_commit="2a8204bfbe8b137cfd296b50d19e59386750fcbc"
pkgrel=0
pkgdesc="Ubuntu Touch keyboard as maliit plugin"
url="https://gitlab.com/ubports/core/lomiri-keyboard"
arch="all"
license="LGPL-3.0-only AND BSD-3-Clause"
makedepends="qt5-qtbase-dev maliit-framework-dev libpinyin-dev gsettings-qt-dev hunspell-dev presage-dev anthy-dev libchewing-dev"
checkdepends="xvfb-run bash"
subpackages="$pkgname-dev $pkgname-lang"
source="https://gitlab.com/ubports/core/lomiri-keyboard/-/archive/$_commit/lomiri-keyboard-$_commit.tar.gz
	0001-Prefix-MALIIT-variables-with-MALIIT_PREFIX.patch
	0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
	"
builddir="$srcdir/$pkgname-$_commit"

build() {
	qmake-qt5 PREFIX=/usr
	make
}

check() {
	xvfb-run -a make check
}

package() {
	make INSTALL_ROOT="$pkgdir" install
	# FIXME Install debian/server.conf into /etc/xdg/maliit.org/server.conf
}

sha512sums="
09f7f1dbed5031f4336d98622f233738479e203f6b41a697814e14faf038a127a9a61f97225fed7ae9f1734c9bfa4ca0d273385f66d15cef380f907367f608e6  lomiri-keyboard-2a8204bfbe8b137cfd296b50d19e59386750fcbc.tar.gz
7aa7b0c0e37cb26fe474e9e55970e5dd3cb65f661af6f4f4ee56ee41bf42836ca32559b8b47d94d4169cc0690d0d77c022e94bf19f26a389450897912521f217  0001-Prefix-MALIIT-variables-with-MALIIT_PREFIX.patch
74082639d95838c1a2c60007160140c008e68086fd09e5e4b4b6b6ca63eaa2d8f58ce4b8a0a9c650664fb06bef698a1e64c5cbe499f619853c5eaca9e3807afd  0002-Fix-up-inputmethodhostprobe-methods-for-maliit-2.0.0.patch
"
